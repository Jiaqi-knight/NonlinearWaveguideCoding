# Autogenerated with SMOP 
from smop.core import *
# 

    
@function
def computeforcingterm3D(N=None,Q=None,Fgeom=None,Fext=None,rho=None,u=None,reciprocalmetriccoefficients=None,scheme=None,invcssq=None,*args,**kwargs):
    varargin = computeforcingterm3D.varargin
    nargin = computeforcingterm3D.nargin

    ##
#        Project: Fluid - structure interaction on deformable surfaces
#         Author: Luca Di Stasio
#    Institution: ETH Zrich
#                 Institute for Building Materials
# Research group: Computational Physics for Engineering Materials
#        Version: 0.1
#  Creation date: May 30th, 2014
#    Last update: June 3rd, 2014
    
    #    Description: F
#          Input: 
#         Output:
    
    ##
    
    F=Fgeom + Fext
    Flambda=zeros(N,Q)
    G11=reciprocalmetriccoefficients[:,1]
    G22=reciprocalmetriccoefficients[:,2]
    G33=reciprocalmetriccoefficients[:,3]
    G12=reciprocalmetriccoefficients[:,4]
    G13=reciprocalmetriccoefficients[:,5]
    G23=reciprocalmetriccoefficients[:,6]
    G21=copy(G12)
    G31=copy(G13)
    G32=copy(G23)
    delta=ones(N,1)
    for i in arange(1,Q).reshape(-1):
        Flambda[:,i]=multiply(multiply(scheme[i,4],rho[:,1]),(multiply(dot(0.5,(G11 - delta + multiply((multiply(u[:,1],u[:,1])),invcssq))),(multiply(multiply(multiply(multiply(scheme[i,1],scheme[i,1]),(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq),invcssq) - multiply(((multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq) - multiply(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]),invcssq) - multiply(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]),invcssq))) + multiply(dot(0.5,(G12 + multiply((multiply(u[:,1],u[:,2])),invcssq))),(multiply(multiply(multiply(multiply(scheme[i,1],scheme[i,2]),(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq),invcssq) - multiply(multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 1]),invcssq) - multiply(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 2]),invcssq))) + multiply(dot(0.5,(G13 + multiply((multiply(u[:,1],u[:,3])),invcssq))),(multiply(multiply(multiply(multiply(scheme[i,1],scheme[i,3]),(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq),invcssq) - multiply(multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 1]),invcssq) - multiply(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 3]),invcssq))) + multiply(dot(0.5,(G21 + multiply((multiply(u[:,2],u[:,1])),invcssq))),(multiply(multiply(multiply(multiply(scheme[i,2],scheme[i,1]),(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq),invcssq) - multiply(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 2]),invcssq) - multiply(multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 1]),invcssq))) + multiply(dot(0.5,(G22 - delta + multiply((multiply(u[:,2],u[:,2])),invcssq))),(multiply(multiply(multiply(multiply(scheme[i,2],scheme[i,2]),(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq),invcssq) - multiply(((multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq) - multiply(multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]),invcssq) - multiply(multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]),invcssq))) + multiply(dot(0.5,(G23 + multiply((multiply(u[:,2],u[:,3])),invcssq))),(multiply(multiply(multiply(multiply(scheme[i,2],scheme[i,3]),(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq),invcssq) - multiply(multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 2]),invcssq) - multiply(multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 3]),invcssq))) + multiply(dot(0.5,(G31 + multiply((multiply(u[:,3],u[:,1])),invcssq))),(multiply(multiply(multiply(multiply(scheme[i,3],scheme[i,1]),(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq),invcssq) - multiply(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 3]),invcssq) - multiply(multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 1]),invcssq))) + multiply(dot(0.5,(G32 + multiply((multiply(u[:,3],u[:,2])),invcssq))),(multiply(multiply(multiply(multiply(scheme[i,3],scheme[i,2]),(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq),invcssq) - multiply(multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 3]),invcssq) - multiply(multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 2]),invcssq))) + multiply(dot(0.5,(G33 - delta + multiply((multiply(u[:,3],u[:,3])),invcssq))),(multiply(multiply(multiply(multiply(scheme[i,3],scheme[i,3]),(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq),invcssq) - multiply(((multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq) - multiply(multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]),invcssq) - multiply(multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]),invcssq))) + multiply((multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3])),invcssq) + multiply(multiply(multiply((multiply(scheme[i,1],u[:,1]) + multiply(scheme[i,2],u[:,2]) + multiply(scheme[i,3],u[:,3])),(multiply(scheme[i,1],F[:,dot(3,(i - 1)) + 1]) + multiply(scheme[i,2],F[:,dot(3,(i - 1)) + 2]) + multiply(scheme[i,3],F[:,dot(3,(i - 1)) + 3]))),invcssq),invcssq) + multiply(- (multiply(u[:,1],F[:,dot(3,(i - 1)) + 1]) + multiply(u[:,2],F[:,dot(3,(i - 1)) + 2]) + multiply(u[:,3],F[:,dot(3,(i - 1)) + 3])),invcssq)))
    
    return Flambda