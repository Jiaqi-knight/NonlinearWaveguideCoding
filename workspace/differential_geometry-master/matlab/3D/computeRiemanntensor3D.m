function[Riemanntensor]=computeRiemanntensor3D(N,deltaq,secondChristoffelsymbol,metriccoefficients,firstdevneighbours)

%%
%        Project: Fluid - structure interaction on deformable surfaces
%         Author: Luca Di Stasio
%    Institution: ETH ZÃ¼rich
%                 Institute for Building Materials
% Research group: Computational Physics for Engineering Materials
%        Version: 0.1
%  Creation date: May 29th, 2014
%    Last update: July 8th, 2014
%
%    Description: 
%          Input: 
%         Output: 

%%

g11 = metriccoefficients(:,1);
g22 = metriccoefficients(:,2);
g33 = metriccoefficients(:,3);
g12 = metriccoefficients(:,4);
g13 = metriccoefficients(:,5);
g23 = metriccoefficients(:,6);

% Gamma_kij

Gamma111 = secondChristoffelsymbol(:,1);
Gamma112 = secondChristoffelsymbol(:,2);
Gamma113 = secondChristoffelsymbol(:,3);
Gamma121 = secondChristoffelsymbol(:,4);
Gamma122 = secondChristoffelsymbol(:,5);
Gamma123 = secondChristoffelsymbol(:,6);
Gamma131 = secondChristoffelsymbol(:,7);
Gamma132 = secondChristoffelsymbol(:,8);
Gamma133 = secondChristoffelsymbol(:,9);
Gamma211 = secondChristoffelsymbol(:,10);
Gamma212 = secondChristoffelsymbol(:,11);
Gamma213 = secondChristoffelsymbol(:,12);
Gamma221 = secondChristoffelsymbol(:,13);
Gamma222 = secondChristoffelsymbol(:,14);
Gamma223 = secondChristoffelsymbol(:,15);
Gamma231 = secondChristoffelsymbol(:,16);
Gamma232 = secondChristoffelsymbol(:,17);
Gamma233 = secondChristoffelsymbol(:,18);
Gamma311 = secondChristoffelsymbol(:,19);
Gamma312 = secondChristoffelsymbol(:,20);
Gamma313 = secondChristoffelsymbol(:,21);
Gamma321 = secondChristoffelsymbol(:,22);
Gamma322 = secondChristoffelsymbol(:,23);
Gamma323 = secondChristoffelsymbol(:,24);
Gamma331 = secondChristoffelsymbol(:,25);
Gamma332 = secondChristoffelsymbol(:,26);
Gamma333 = secondChristoffelsymbol(:,27);

Gamma111d1 = zeros(N,1);
Gamma112d1 = zeros(N,1);
Gamma113d1 = zeros(N,1);
Gamma121d1 = zeros(N,1);
Gamma122d1 = zeros(N,1);
Gamma123d1 = zeros(N,1);
Gamma131d1 = zeros(N,1);
Gamma132d1 = zeros(N,1);
Gamma133d1 = zeros(N,1);
Gamma211d1 = zeros(N,1);
Gamma212d1 = zeros(N,1);
Gamma213d1 = zeros(N,1);
Gamma221d1 = zeros(N,1);
Gamma222d1 = zeros(N,1);
Gamma223d1 = zeros(N,1);
Gamma231d1 = zeros(N,1);
Gamma232d1 = zeros(N,1);
Gamma233d1 = zeros(N,1);
Gamma311d1 = zeros(N,1);
Gamma312d1 = zeros(N,1);
Gamma313d1 = zeros(N,1);
Gamma321d1 = zeros(N,1);
Gamma322d1 = zeros(N,1);
Gamma323d1 = zeros(N,1);
Gamma331d1 = zeros(N,1);
Gamma332d1 = zeros(N,1);
Gamma333d1 = zeros(N,1);

Gamma111d2 = zeros(N,1);
Gamma112d2 = zeros(N,1);
Gamma113d2 = zeros(N,1);
Gamma121d2 = zeros(N,1);
Gamma122d2 = zeros(N,1);
Gamma123d2 = zeros(N,1);
Gamma131d2 = zeros(N,1);
Gamma132d2 = zeros(N,1);
Gamma133d2 = zeros(N,1);
Gamma211d2 = zeros(N,1);
Gamma212d2 = zeros(N,1);
Gamma213d2 = zeros(N,1);
Gamma221d2 = zeros(N,1);
Gamma222d2 = zeros(N,1);
Gamma223d2 = zeros(N,1);
Gamma231d2 = zeros(N,1);
Gamma232d2 = zeros(N,1);
Gamma233d2 = zeros(N,1);
Gamma311d2 = zeros(N,1);
Gamma312d2 = zeros(N,1);
Gamma313d2 = zeros(N,1);
Gamma321d2 = zeros(N,1);
Gamma322d2 = zeros(N,1);
Gamma323d2 = zeros(N,1);
Gamma331d2 = zeros(N,1);
Gamma332d2 = zeros(N,1);
Gamma333d2 = zeros(N,1);

Gamma111d3 = zeros(N,1);
Gamma112d3 = zeros(N,1);
Gamma113d3 = zeros(N,1);
Gamma121d3 = zeros(N,1);
Gamma122d3 = zeros(N,1);
Gamma123d3 = zeros(N,1);
Gamma131d3 = zeros(N,1);
Gamma132d3 = zeros(N,1);
Gamma133d3 = zeros(N,1);
Gamma211d3 = zeros(N,1);
Gamma212d3 = zeros(N,1);
Gamma213d3 = zeros(N,1);
Gamma221d3 = zeros(N,1);
Gamma222d3 = zeros(N,1);
Gamma223d3 = zeros(N,1);
Gamma231d3 = zeros(N,1);
Gamma232d3 = zeros(N,1);
Gamma233d3 = zeros(N,1);
Gamma311d3 = zeros(N,1);
Gamma312d3 = zeros(N,1);
Gamma313d3 = zeros(N,1);
Gamma321d3 = zeros(N,1);
Gamma322d3 = zeros(N,1);
Gamma323d3 = zeros(N,1);
Gamma331d3 = zeros(N,1);
Gamma332d3 = zeros(N,1);
Gamma333d3 = zeros(N,1);

for i=1:N
    j1 = 1;
    switch firstdevneighbours(i,4*(j1-1)+1)
        case 1
            Gamma111d1(i,1) = 0.5.*(Gamma111(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma111(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma112d1(i,1) = 0.5.*(Gamma112(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma112(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma113d1(i,1) = 0.5.*(Gamma113(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma113(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma121d1(i,1) = 0.5.*(Gamma121(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma121(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma122d1(i,1) = 0.5.*(Gamma122(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma122(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma123d1(i,1) = 0.5.*(Gamma123(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma123(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma131d1(i,1) = 0.5.*(Gamma131(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma131(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma132d1(i,1) = 0.5.*(Gamma132(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma132(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma133d1(i,1) = 0.5.*(Gamma133(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma133(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma211d1(i,1) = 0.5.*(Gamma211(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma211(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma212d1(i,1) = 0.5.*(Gamma212(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma212(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma213d1(i,1) = 0.5.*(Gamma213(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma213(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma221d1(i,1) = 0.5.*(Gamma221(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma221(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma222d1(i,1) = 0.5.*(Gamma222(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma222(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma223d1(i,1) = 0.5.*(Gamma223(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma223(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma231d1(i,1) = 0.5.*(Gamma231(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma231(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma232d1(i,1) = 0.5.*(Gamma232(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma232(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma233d1(i,1) = 0.5.*(Gamma233(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma233(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma311d1(i,1) = 0.5.*(Gamma311(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma311(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma312d1(i,1) = 0.5.*(Gamma312(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma312(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma313d1(i,1) = 0.5.*(Gamma313(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma313(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma321d1(i,1) = 0.5.*(Gamma321(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma321(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma322d1(i,1) = 0.5.*(Gamma322(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma322(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma323d1(i,1) = 0.5.*(Gamma323(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma323(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma331d1(i,1) = 0.5.*(Gamma331(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma331(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma332d1(i,1) = 0.5.*(Gamma332(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma332(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
            Gamma333d1(i,1) = 0.5.*(Gamma333(firstdevneighbours(i,4*(j1-1)+3),1)-Gamma333(firstdevneighbours(i,4*(j1-1)+2),1))./deltaq(j1);
        case 2
            Gamma111d1(i,1) = (-1.5*Gamma111(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma111(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma111(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma112d1(i,1) = (-1.5*Gamma112(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma112(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma112(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma113d1(i,1) = (-1.5*Gamma113(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma113(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma113(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma121d1(i,1) = (-1.5*Gamma121(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma121(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma121(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma122d1(i,1) = (-1.5*Gamma122(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma122(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma122(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma123d1(i,1) = (-1.5*Gamma123(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma123(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma123(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma131d1(i,1) = (-1.5*Gamma131(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma131(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma131(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma132d1(i,1) = (-1.5*Gamma132(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma132(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma132(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma133d1(i,1) = (-1.5*Gamma133(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma133(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma133(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma211d1(i,1) = (-1.5*Gamma211(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma211(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma211(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma212d1(i,1) = (-1.5*Gamma212(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma212(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma212(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma213d1(i,1) = (-1.5*Gamma213(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma213(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma213(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma221d1(i,1) = (-1.5*Gamma221(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma221(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma221(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma222d1(i,1) = (-1.5*Gamma222(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma222(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma222(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma223d1(i,1) = (-1.5*Gamma223(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma223(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma223(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma231d1(i,1) = (-1.5*Gamma231(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma231(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma231(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma232d1(i,1) = (-1.5*Gamma232(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma232(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma232(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma233d1(i,1) = (-1.5*Gamma233(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma233(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma233(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma311d1(i,1) = (-1.5*Gamma311(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma311(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma311(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma312d1(i,1) = (-1.5*Gamma312(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma312(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma312(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma313d1(i,1) = (-1.5*Gamma313(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma313(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma313(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma321d1(i,1) = (-1.5*Gamma321(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma321(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma321(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma322d1(i,1) = (-1.5*Gamma322(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma322(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma322(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma323d1(i,1) = (-1.5*Gamma323(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma323(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma323(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma331d1(i,1) = (-1.5*Gamma331(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma331(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma331(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma332d1(i,1) = (-1.5*Gamma332(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma332(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma332(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma333d1(i,1) = (-1.5*Gamma333(firstdevneighbours(i,4*(j1-1)+2),1)+2*Gamma333(firstdevneighbours(i,4*(j1-1)+3),1)-0.5*Gamma333(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
        case 3
            Gamma111d1(i,1) = (1.5*Gamma111(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma111(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma111(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma112d1(i,1) = (1.5*Gamma112(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma112(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma112(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma113d1(i,1) = (1.5*Gamma113(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma113(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma113(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma121d1(i,1) = (1.5*Gamma121(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma121(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma121(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma122d1(i,1) = (1.5*Gamma122(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma122(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma122(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma123d1(i,1) = (1.5*Gamma123(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma123(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma123(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma131d1(i,1) = (1.5*Gamma131(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma131(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma131(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma132d1(i,1) = (1.5*Gamma132(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma132(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma132(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma133d1(i,1) = (1.5*Gamma133(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma133(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma133(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma211d1(i,1) = (1.5*Gamma211(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma211(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma211(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma212d1(i,1) = (1.5*Gamma212(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma212(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma212(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma213d1(i,1) = (1.5*Gamma213(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma213(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma213(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma221d1(i,1) = (1.5*Gamma221(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma221(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma221(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma222d1(i,1) = (1.5*Gamma222(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma222(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma222(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma223d1(i,1) = (1.5*Gamma223(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma223(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma223(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma231d1(i,1) = (1.5*Gamma231(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma231(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma231(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma232d1(i,1) = (1.5*Gamma232(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma232(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma232(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma233d1(i,1) = (1.5*Gamma233(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma233(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma233(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma311d1(i,1) = (1.5*Gamma311(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma311(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma311(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma312d1(i,1) = (1.5*Gamma312(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma312(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma312(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma313d1(i,1) = (1.5*Gamma313(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma313(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma313(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma321d1(i,1) = (1.5*Gamma321(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma321(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma321(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma322d1(i,1) = (1.5*Gamma322(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma322(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma322(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma323d1(i,1) = (1.5*Gamma323(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma323(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma323(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma331d1(i,1) = (1.5*Gamma331(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma331(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma331(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma332d1(i,1) = (1.5*Gamma332(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma332(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma332(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
            Gamma333d1(i,1) = (1.5*Gamma333(firstdevneighbours(i,4*(j1-1)+2),1)-2*Gamma333(firstdevneighbours(i,4*(j1-1)+3),1)+0.5*Gamma333(firstdevneighbours(i,4*(j1-1)+4),1))./deltaq(j1);
    end
    j2 = 2;
    switch firstdevneighbours(i,4*(j2-1)+1)
        case 1
            Gamma111d2(i,1) = 0.5.*(Gamma111(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma111(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma112d2(i,1) = 0.5.*(Gamma112(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma112(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma113d2(i,1) = 0.5.*(Gamma113(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma113(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma121d2(i,1) = 0.5.*(Gamma121(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma121(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma122d2(i,1) = 0.5.*(Gamma122(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma122(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma123d2(i,1) = 0.5.*(Gamma123(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma123(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma131d2(i,1) = 0.5.*(Gamma131(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma131(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma132d2(i,1) = 0.5.*(Gamma132(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma132(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma133d2(i,1) = 0.5.*(Gamma133(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma133(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma211d2(i,1) = 0.5.*(Gamma211(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma211(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma212d2(i,1) = 0.5.*(Gamma212(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma212(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma213d2(i,1) = 0.5.*(Gamma213(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma213(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma221d2(i,1) = 0.5.*(Gamma221(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma221(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma222d2(i,1) = 0.5.*(Gamma222(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma222(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma223d2(i,1) = 0.5.*(Gamma223(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma223(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma231d2(i,1) = 0.5.*(Gamma231(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma231(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma232d2(i,1) = 0.5.*(Gamma232(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma232(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma233d2(i,1) = 0.5.*(Gamma233(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma233(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma311d2(i,1) = 0.5.*(Gamma311(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma311(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma312d2(i,1) = 0.5.*(Gamma312(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma312(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma313d2(i,1) = 0.5.*(Gamma313(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma313(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma321d2(i,1) = 0.5.*(Gamma321(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma321(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma322d2(i,1) = 0.5.*(Gamma322(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma322(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma323d2(i,1) = 0.5.*(Gamma323(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma323(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma331d2(i,1) = 0.5.*(Gamma331(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma331(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma332d2(i,1) = 0.5.*(Gamma332(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma332(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
            Gamma333d2(i,1) = 0.5.*(Gamma333(firstdevneighbours(i,4*(j2-1)+3),1)-Gamma333(firstdevneighbours(i,4*(j2-1)+2),1))./deltaq(j2);
        case 2
            Gamma111d2(i,1) = (-1.5*Gamma111(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma111(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma111(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma112d2(i,1) = (-1.5*Gamma112(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma112(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma112(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma113d2(i,1) = (-1.5*Gamma113(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma113(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma113(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma121d2(i,1) = (-1.5*Gamma121(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma121(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma121(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma122d2(i,1) = (-1.5*Gamma122(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma122(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma122(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma123d2(i,1) = (-1.5*Gamma123(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma123(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma123(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma131d2(i,1) = (-1.5*Gamma131(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma131(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma131(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma132d2(i,1) = (-1.5*Gamma132(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma132(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma132(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma133d2(i,1) = (-1.5*Gamma133(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma133(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma133(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma211d2(i,1) = (-1.5*Gamma211(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma211(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma211(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma212d2(i,1) = (-1.5*Gamma212(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma212(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma212(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma213d2(i,1) = (-1.5*Gamma213(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma213(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma213(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma221d2(i,1) = (-1.5*Gamma221(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma221(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma221(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma222d2(i,1) = (-1.5*Gamma222(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma222(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma222(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma223d2(i,1) = (-1.5*Gamma223(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma223(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma223(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma231d2(i,1) = (-1.5*Gamma231(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma231(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma231(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma232d2(i,1) = (-1.5*Gamma232(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma232(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma232(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma233d2(i,1) = (-1.5*Gamma233(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma233(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma233(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma311d2(i,1) = (-1.5*Gamma311(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma311(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma311(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma312d2(i,1) = (-1.5*Gamma312(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma312(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma312(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma313d2(i,1) = (-1.5*Gamma313(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma313(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma313(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma321d2(i,1) = (-1.5*Gamma321(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma321(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma321(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma322d2(i,1) = (-1.5*Gamma322(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma322(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma322(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma323d2(i,1) = (-1.5*Gamma323(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma323(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma323(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma331d2(i,1) = (-1.5*Gamma331(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma331(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma331(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma332d2(i,1) = (-1.5*Gamma332(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma332(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma332(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma333d2(i,1) = (-1.5*Gamma333(firstdevneighbours(i,4*(j2-1)+2),1)+2*Gamma333(firstdevneighbours(i,4*(j2-1)+3),1)-0.5*Gamma333(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
        case 3
            Gamma111d2(i,1) = (1.5*Gamma111(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma111(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma111(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma112d2(i,1) = (1.5*Gamma112(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma112(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma112(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma113d2(i,1) = (1.5*Gamma113(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma113(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma113(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma121d2(i,1) = (1.5*Gamma121(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma121(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma121(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma122d2(i,1) = (1.5*Gamma122(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma122(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma122(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma123d2(i,1) = (1.5*Gamma123(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma123(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma123(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma131d2(i,1) = (1.5*Gamma131(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma131(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma131(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma132d2(i,1) = (1.5*Gamma132(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma132(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma132(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma133d2(i,1) = (1.5*Gamma133(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma133(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma133(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma211d2(i,1) = (1.5*Gamma211(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma211(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma211(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma212d2(i,1) = (1.5*Gamma212(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma212(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma212(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma213d2(i,1) = (1.5*Gamma213(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma213(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma213(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma221d2(i,1) = (1.5*Gamma221(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma221(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma221(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma222d2(i,1) = (1.5*Gamma222(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma222(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma222(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma223d2(i,1) = (1.5*Gamma223(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma223(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma223(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma231d2(i,1) = (1.5*Gamma231(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma231(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma231(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma232d2(i,1) = (1.5*Gamma232(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma232(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma232(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma233d2(i,1) = (1.5*Gamma233(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma233(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma233(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma311d2(i,1) = (1.5*Gamma311(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma311(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma311(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma312d2(i,1) = (1.5*Gamma312(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma312(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma312(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma313d2(i,1) = (1.5*Gamma313(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma313(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma313(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma321d2(i,1) = (1.5*Gamma321(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma321(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma321(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma322d2(i,1) = (1.5*Gamma322(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma322(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma322(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma323d2(i,1) = (1.5*Gamma323(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma323(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma323(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma331d2(i,1) = (1.5*Gamma331(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma331(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma331(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma332d2(i,1) = (1.5*Gamma332(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma332(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma332(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
            Gamma333d2(i,1) = (1.5*Gamma333(firstdevneighbours(i,4*(j2-1)+2),1)-2*Gamma333(firstdevneighbours(i,4*(j2-1)+3),1)+0.5*Gamma333(firstdevneighbours(i,4*(j2-1)+4),1))./deltaq(j2);
    end
    j3 = 3;
    switch firstdevneighbours(i,4*(j3-1)+1)
        case 1
            Gamma111d3(i,1) = 0.5.*(Gamma111(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma111(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma112d3(i,1) = 0.5.*(Gamma112(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma112(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma113d3(i,1) = 0.5.*(Gamma113(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma113(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma121d3(i,1) = 0.5.*(Gamma121(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma121(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma122d3(i,1) = 0.5.*(Gamma122(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma122(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma123d3(i,1) = 0.5.*(Gamma123(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma123(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma131d3(i,1) = 0.5.*(Gamma131(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma131(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma132d3(i,1) = 0.5.*(Gamma132(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma132(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma133d3(i,1) = 0.5.*(Gamma133(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma133(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma211d3(i,1) = 0.5.*(Gamma211(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma211(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma212d3(i,1) = 0.5.*(Gamma212(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma212(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma213d3(i,1) = 0.5.*(Gamma213(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma213(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma221d3(i,1) = 0.5.*(Gamma221(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma221(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma222d3(i,1) = 0.5.*(Gamma222(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma222(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma223d3(i,1) = 0.5.*(Gamma223(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma223(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma231d3(i,1) = 0.5.*(Gamma231(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma231(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma232d3(i,1) = 0.5.*(Gamma232(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma232(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma233d3(i,1) = 0.5.*(Gamma233(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma233(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma311d3(i,1) = 0.5.*(Gamma311(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma311(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma312d3(i,1) = 0.5.*(Gamma312(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma312(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma313d3(i,1) = 0.5.*(Gamma313(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma313(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma321d3(i,1) = 0.5.*(Gamma321(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma321(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma322d3(i,1) = 0.5.*(Gamma322(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma322(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma323d3(i,1) = 0.5.*(Gamma323(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma323(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma331d3(i,1) = 0.5.*(Gamma331(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma331(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma332d3(i,1) = 0.5.*(Gamma332(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma332(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
            Gamma333d3(i,1) = 0.5.*(Gamma333(firstdevneighbours(i,4*(j3-1)+3),1)-Gamma333(firstdevneighbours(i,4*(j3-1)+2),1))./deltaq(j3);
        case 2
            Gamma111d3(i,1) = (-1.5*Gamma111(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma111(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma111(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma112d3(i,1) = (-1.5*Gamma112(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma112(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma112(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma113d3(i,1) = (-1.5*Gamma113(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma113(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma113(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma121d3(i,1) = (-1.5*Gamma121(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma121(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma121(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma122d3(i,1) = (-1.5*Gamma122(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma122(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma122(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma123d3(i,1) = (-1.5*Gamma123(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma123(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma123(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma131d3(i,1) = (-1.5*Gamma131(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma131(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma131(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma132d3(i,1) = (-1.5*Gamma132(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma132(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma132(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma133d3(i,1) = (-1.5*Gamma133(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma133(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma133(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma211d3(i,1) = (-1.5*Gamma211(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma211(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma211(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma212d3(i,1) = (-1.5*Gamma212(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma212(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma212(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma213d3(i,1) = (-1.5*Gamma213(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma213(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma213(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma221d3(i,1) = (-1.5*Gamma221(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma221(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma221(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma222d3(i,1) = (-1.5*Gamma222(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma222(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma222(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma223d3(i,1) = (-1.5*Gamma223(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma223(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma223(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma231d3(i,1) = (-1.5*Gamma231(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma231(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma231(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma232d3(i,1) = (-1.5*Gamma232(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma232(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma232(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma233d3(i,1) = (-1.5*Gamma233(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma233(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma233(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma311d3(i,1) = (-1.5*Gamma311(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma311(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma311(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma312d3(i,1) = (-1.5*Gamma312(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma312(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma312(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma313d3(i,1) = (-1.5*Gamma313(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma313(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma313(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma321d3(i,1) = (-1.5*Gamma321(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma321(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma321(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma322d3(i,1) = (-1.5*Gamma322(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma322(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma322(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma323d3(i,1) = (-1.5*Gamma323(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma323(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma323(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma331d3(i,1) = (-1.5*Gamma331(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma331(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma331(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma332d3(i,1) = (-1.5*Gamma332(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma332(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma332(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma333d3(i,1) = (-1.5*Gamma333(firstdevneighbours(i,4*(j3-1)+2),1)+2*Gamma333(firstdevneighbours(i,4*(j3-1)+3),1)-0.5*Gamma333(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
        case 3
            Gamma111d3(i,1) = (1.5*Gamma111(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma111(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma111(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma112d3(i,1) = (1.5*Gamma112(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma112(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma112(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma113d3(i,1) = (1.5*Gamma113(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma113(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma113(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma121d3(i,1) = (1.5*Gamma121(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma121(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma121(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma122d3(i,1) = (1.5*Gamma122(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma122(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma122(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma123d3(i,1) = (1.5*Gamma123(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma123(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma123(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma131d3(i,1) = (1.5*Gamma131(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma131(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma131(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma132d3(i,1) = (1.5*Gamma132(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma132(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma132(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma133d3(i,1) = (1.5*Gamma133(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma133(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma133(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma211d3(i,1) = (1.5*Gamma211(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma211(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma211(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma212d3(i,1) = (1.5*Gamma212(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma212(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma212(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma213d3(i,1) = (1.5*Gamma213(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma213(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma213(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma221d3(i,1) = (1.5*Gamma221(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma221(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma221(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma222d3(i,1) = (1.5*Gamma222(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma222(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma222(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma223d3(i,1) = (1.5*Gamma223(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma223(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma223(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma231d3(i,1) = (1.5*Gamma231(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma231(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma231(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma232d3(i,1) = (1.5*Gamma232(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma232(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma232(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma233d3(i,1) = (1.5*Gamma233(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma233(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma233(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma311d3(i,1) = (1.5*Gamma311(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma311(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma311(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma312d3(i,1) = (1.5*Gamma312(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma312(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma312(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma313d3(i,1) = (1.5*Gamma313(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma313(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma313(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma321d3(i,1) = (1.5*Gamma321(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma321(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma321(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma322d3(i,1) = (1.5*Gamma322(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma322(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma322(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma323d3(i,1) = (1.5*Gamma323(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma323(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma323(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma331d3(i,1) = (1.5*Gamma331(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma331(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma331(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma332d3(i,1) = (1.5*Gamma332(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma332(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma332(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
            Gamma333d3(i,1) = (1.5*Gamma333(firstdevneighbours(i,4*(j3-1)+2),1)-2*Gamma333(firstdevneighbours(i,4*(j3-1)+3),1)+0.5*Gamma333(firstdevneighbours(i,4*(j3-1)+4),1))./deltaq(j3);
    end
end

% Rlijk = Gamma_lik/j - Gamma_lij/k + Gamma_ljs*Gamma_sik - Gamma_lks*Gamma_sij

R1111 = Gamma111d1 - Gamma111d1 + (Gamma111.*Gamma111 + Gamma112.*Gamma211 + Gamma113.*Gamma311) - (Gamma111.*Gamma111 + Gamma112.*Gamma211 + Gamma113.*Gamma311);
R1112 = Gamma112d1 - Gamma111d2 + (Gamma111.*Gamma112 + Gamma112.*Gamma212 + Gamma113.*Gamma312) - (Gamma121.*Gamma111 + Gamma122.*Gamma211 + Gamma123.*Gamma311);
R1113 = Gamma113d1 - Gamma111d3 + (Gamma111.*Gamma113 + Gamma112.*Gamma213 + Gamma113.*Gamma313) - (Gamma131.*Gamma111 + Gamma132.*Gamma211 + Gamma133.*Gamma311);
R1121 = Gamma111d2 - Gamma112d1 + (Gamma121.*Gamma111 + Gamma122.*Gamma211 + Gamma123.*Gamma311) - (Gamma111.*Gamma112 + Gamma112.*Gamma212 + Gamma113.*Gamma312);
R1122 = Gamma112d2 - Gamma112d2 + (Gamma121.*Gamma112 + Gamma122.*Gamma212 + Gamma123.*Gamma312) - (Gamma121.*Gamma112 + Gamma122.*Gamma212 + Gamma123.*Gamma312);
R1123 = Gamma113d2 - Gamma112d3 + (Gamma121.*Gamma113 + Gamma122.*Gamma213 + Gamma123.*Gamma313) - (Gamma131.*Gamma112 + Gamma132.*Gamma212 + Gamma133.*Gamma312);
R1131 = Gamma111d3 - Gamma113d1 + (Gamma131.*Gamma111 + Gamma132.*Gamma211 + Gamma133.*Gamma311) - (Gamma111.*Gamma113 + Gamma112.*Gamma213 + Gamma113.*Gamma313);
R1132 = Gamma112d3 - Gamma113d2 + (Gamma131.*Gamma112 + Gamma132.*Gamma212 + Gamma133.*Gamma312) - (Gamma121.*Gamma113 + Gamma122.*Gamma213 + Gamma123.*Gamma313);
R1133 = Gamma113d3 - Gamma113d3 + (Gamma131.*Gamma113 + Gamma132.*Gamma213 + Gamma133.*Gamma313) - (Gamma131.*Gamma113 + Gamma132.*Gamma213 + Gamma133.*Gamma313);
R1211 = Gamma121d1 - Gamma121d1 + (Gamma111.*Gamma121 + Gamma112.*Gamma221 + Gamma113.*Gamma321) - (Gamma111.*Gamma121 + Gamma112.*Gamma221 + Gamma113.*Gamma321);
R1212 = Gamma122d1 - Gamma121d2 + (Gamma111.*Gamma122 + Gamma112.*Gamma222 + Gamma113.*Gamma322) - (Gamma121.*Gamma121 + Gamma122.*Gamma221 + Gamma123.*Gamma321);
R1213 = Gamma123d1 - Gamma121d3 + (Gamma111.*Gamma123 + Gamma112.*Gamma223 + Gamma113.*Gamma323) - (Gamma131.*Gamma121 + Gamma132.*Gamma221 + Gamma133.*Gamma321);
R1221 = Gamma121d2 - Gamma122d1 + (Gamma121.*Gamma121 + Gamma122.*Gamma221 + Gamma123.*Gamma321) - (Gamma111.*Gamma122 + Gamma112.*Gamma222 + Gamma113.*Gamma322);
R1222 = Gamma122d2 - Gamma122d2 + (Gamma121.*Gamma122 + Gamma122.*Gamma222 + Gamma123.*Gamma322) - (Gamma121.*Gamma122 + Gamma122.*Gamma222 + Gamma123.*Gamma322);
R1223 = Gamma123d2 - Gamma122d3 + (Gamma121.*Gamma123 + Gamma122.*Gamma223 + Gamma123.*Gamma323) - (Gamma131.*Gamma122 + Gamma132.*Gamma222 + Gamma133.*Gamma322);
R1231 = Gamma121d3 - Gamma123d1 + (Gamma131.*Gamma121 + Gamma132.*Gamma221 + Gamma133.*Gamma321) - (Gamma111.*Gamma123 + Gamma112.*Gamma223 + Gamma113.*Gamma323);
R1232 = Gamma122d3 - Gamma123d2 + (Gamma131.*Gamma122 + Gamma132.*Gamma222 + Gamma133.*Gamma322) - (Gamma121.*Gamma123 + Gamma122.*Gamma223 + Gamma123.*Gamma323);
R1233 = Gamma123d3 - Gamma123d3 + (Gamma131.*Gamma123 + Gamma132.*Gamma223 + Gamma133.*Gamma323) - (Gamma131.*Gamma123 + Gamma132.*Gamma223 + Gamma133.*Gamma323);
R1311 = Gamma131d1 - Gamma131d1 + (Gamma111.*Gamma131 + Gamma112.*Gamma231 + Gamma113.*Gamma331) - (Gamma111.*Gamma131 + Gamma112.*Gamma231 + Gamma113.*Gamma331);
R1312 = Gamma132d1 - Gamma131d2 + (Gamma111.*Gamma132 + Gamma112.*Gamma232 + Gamma113.*Gamma332) - (Gamma121.*Gamma131 + Gamma122.*Gamma231 + Gamma123.*Gamma331);
R1313 = Gamma133d1 - Gamma131d3 + (Gamma111.*Gamma133 + Gamma112.*Gamma233 + Gamma113.*Gamma333) - (Gamma131.*Gamma131 + Gamma132.*Gamma231 + Gamma133.*Gamma331);
R1321 = Gamma131d2 - Gamma132d1 + (Gamma121.*Gamma131 + Gamma122.*Gamma231 + Gamma123.*Gamma331) - (Gamma111.*Gamma132 + Gamma112.*Gamma232 + Gamma113.*Gamma332);
R1322 = Gamma132d2 - Gamma132d2 + (Gamma121.*Gamma132 + Gamma122.*Gamma232 + Gamma123.*Gamma332) - (Gamma121.*Gamma132 + Gamma122.*Gamma232 + Gamma123.*Gamma332);
R1323 = Gamma133d2 - Gamma132d3 + (Gamma121.*Gamma133 + Gamma122.*Gamma233 + Gamma123.*Gamma333) - (Gamma131.*Gamma132 + Gamma132.*Gamma232 + Gamma133.*Gamma332);
R1331 = Gamma131d3 - Gamma133d1 + (Gamma131.*Gamma131 + Gamma132.*Gamma231 + Gamma133.*Gamma331) - (Gamma111.*Gamma133 + Gamma112.*Gamma233 + Gamma113.*Gamma333);
R1332 = Gamma132d3 - Gamma133d2 + (Gamma131.*Gamma132 + Gamma132.*Gamma232 + Gamma133.*Gamma332) - (Gamma121.*Gamma133 + Gamma122.*Gamma233 + Gamma123.*Gamma333);
R1333 = Gamma133d3 - Gamma133d3 + (Gamma131.*Gamma133 + Gamma132.*Gamma233 + Gamma133.*Gamma333) - (Gamma131.*Gamma133 + Gamma132.*Gamma233 + Gamma133.*Gamma333);
R2111 = Gamma211d1 - Gamma211d1 + (Gamma211.*Gamma111 + Gamma212.*Gamma211 + Gamma213.*Gamma311) - (Gamma211.*Gamma111 + Gamma212.*Gamma211 + Gamma213.*Gamma311);
R2112 = Gamma212d1 - Gamma211d2 + (Gamma211.*Gamma112 + Gamma212.*Gamma212 + Gamma213.*Gamma312) - (Gamma221.*Gamma111 + Gamma222.*Gamma211 + Gamma223.*Gamma311);
R2113 = Gamma213d1 - Gamma211d3 + (Gamma211.*Gamma113 + Gamma212.*Gamma213 + Gamma213.*Gamma313) - (Gamma231.*Gamma111 + Gamma232.*Gamma211 + Gamma233.*Gamma311);
R2121 = Gamma211d2 - Gamma212d1 + (Gamma221.*Gamma111 + Gamma222.*Gamma211 + Gamma223.*Gamma311) - (Gamma211.*Gamma112 + Gamma212.*Gamma212 + Gamma213.*Gamma312);
R2122 = Gamma212d2 - Gamma212d2 + (Gamma221.*Gamma112 + Gamma222.*Gamma212 + Gamma223.*Gamma312) - (Gamma221.*Gamma112 + Gamma222.*Gamma212 + Gamma223.*Gamma312);
R2123 = Gamma213d2 - Gamma212d3 + (Gamma221.*Gamma113 + Gamma222.*Gamma213 + Gamma223.*Gamma313) - (Gamma231.*Gamma112 + Gamma232.*Gamma212 + Gamma233.*Gamma312);
R2131 = Gamma211d3 - Gamma213d1 + (Gamma231.*Gamma111 + Gamma232.*Gamma211 + Gamma233.*Gamma311) - (Gamma211.*Gamma113 + Gamma212.*Gamma213 + Gamma213.*Gamma313);
R2132 = Gamma212d3 - Gamma213d2 + (Gamma231.*Gamma112 + Gamma232.*Gamma212 + Gamma233.*Gamma312) - (Gamma221.*Gamma113 + Gamma222.*Gamma213 + Gamma223.*Gamma313);
R2133 = Gamma213d3 - Gamma213d3 + (Gamma231.*Gamma113 + Gamma232.*Gamma213 + Gamma233.*Gamma313) - (Gamma231.*Gamma113 + Gamma232.*Gamma213 + Gamma233.*Gamma313);
R2211 = Gamma221d1 - Gamma221d1 + (Gamma211.*Gamma121 + Gamma212.*Gamma221 + Gamma213.*Gamma321) - (Gamma211.*Gamma121 + Gamma212.*Gamma221 + Gamma213.*Gamma321);
R2212 = Gamma222d1 - Gamma221d2 + (Gamma211.*Gamma122 + Gamma212.*Gamma222 + Gamma213.*Gamma322) - (Gamma221.*Gamma121 + Gamma222.*Gamma221 + Gamma223.*Gamma321);
R2213 = Gamma223d1 - Gamma221d3 + (Gamma211.*Gamma123 + Gamma212.*Gamma223 + Gamma213.*Gamma323) - (Gamma231.*Gamma121 + Gamma232.*Gamma221 + Gamma233.*Gamma321);
R2221 = Gamma221d2 - Gamma222d1 + (Gamma221.*Gamma121 + Gamma222.*Gamma221 + Gamma223.*Gamma321) - (Gamma211.*Gamma122 + Gamma212.*Gamma222 + Gamma213.*Gamma322);
R2222 = Gamma222d2 - Gamma222d2 + (Gamma221.*Gamma122 + Gamma222.*Gamma222 + Gamma223.*Gamma322) - (Gamma221.*Gamma122 + Gamma222.*Gamma222 + Gamma223.*Gamma322);
R2223 = Gamma223d2 - Gamma222d3 + (Gamma221.*Gamma123 + Gamma222.*Gamma223 + Gamma223.*Gamma323) - (Gamma231.*Gamma122 + Gamma232.*Gamma222 + Gamma233.*Gamma322);
R2231 = Gamma221d3 - Gamma223d1 + (Gamma231.*Gamma121 + Gamma232.*Gamma221 + Gamma233.*Gamma321) - (Gamma211.*Gamma123 + Gamma212.*Gamma223 + Gamma213.*Gamma323);
R2232 = Gamma222d3 - Gamma223d2 + (Gamma231.*Gamma122 + Gamma232.*Gamma222 + Gamma233.*Gamma322) - (Gamma221.*Gamma123 + Gamma222.*Gamma223 + Gamma223.*Gamma323);
R2233 = Gamma223d3 - Gamma223d3 + (Gamma231.*Gamma123 + Gamma232.*Gamma223 + Gamma233.*Gamma323) - (Gamma231.*Gamma123 + Gamma232.*Gamma223 + Gamma233.*Gamma323);
R2311 = Gamma231d1 - Gamma231d1 + (Gamma211.*Gamma131 + Gamma212.*Gamma231 + Gamma213.*Gamma331) - (Gamma211.*Gamma131 + Gamma212.*Gamma231 + Gamma213.*Gamma331);
R2312 = Gamma232d1 - Gamma231d2 + (Gamma211.*Gamma132 + Gamma212.*Gamma232 + Gamma213.*Gamma332) - (Gamma221.*Gamma131 + Gamma222.*Gamma231 + Gamma223.*Gamma331);
R2313 = Gamma233d1 - Gamma231d3 + (Gamma211.*Gamma133 + Gamma212.*Gamma233 + Gamma213.*Gamma333) - (Gamma231.*Gamma131 + Gamma232.*Gamma231 + Gamma233.*Gamma331);
R2321 = Gamma231d2 - Gamma232d1 + (Gamma221.*Gamma131 + Gamma222.*Gamma231 + Gamma223.*Gamma331) - (Gamma211.*Gamma132 + Gamma212.*Gamma232 + Gamma213.*Gamma332);
R2322 = Gamma232d2 - Gamma232d2 + (Gamma221.*Gamma132 + Gamma222.*Gamma232 + Gamma223.*Gamma332) - (Gamma221.*Gamma132 + Gamma222.*Gamma232 + Gamma223.*Gamma332);
R2323 = Gamma233d2 - Gamma232d3 + (Gamma221.*Gamma133 + Gamma222.*Gamma233 + Gamma223.*Gamma333) - (Gamma231.*Gamma132 + Gamma232.*Gamma232 + Gamma233.*Gamma332);
R2331 = Gamma231d3 - Gamma233d1 + (Gamma231.*Gamma131 + Gamma232.*Gamma231 + Gamma233.*Gamma331) - (Gamma211.*Gamma133 + Gamma212.*Gamma233 + Gamma213.*Gamma333);
R2332 = Gamma232d3 - Gamma233d2 + (Gamma231.*Gamma132 + Gamma232.*Gamma232 + Gamma233.*Gamma332) - (Gamma221.*Gamma133 + Gamma222.*Gamma233 + Gamma223.*Gamma333);
R2333 = Gamma233d3 - Gamma233d3 + (Gamma231.*Gamma133 + Gamma232.*Gamma233 + Gamma233.*Gamma333) - (Gamma231.*Gamma133 + Gamma232.*Gamma233 + Gamma233.*Gamma333);
R3111 = Gamma311d1 - Gamma311d1 + (Gamma311.*Gamma111 + Gamma312.*Gamma211 + Gamma313.*Gamma311) - (Gamma311.*Gamma111 + Gamma312.*Gamma211 + Gamma313.*Gamma311);
R3112 = Gamma312d1 - Gamma311d2 + (Gamma311.*Gamma112 + Gamma312.*Gamma212 + Gamma313.*Gamma312) - (Gamma321.*Gamma111 + Gamma322.*Gamma211 + Gamma323.*Gamma311);
R3113 = Gamma313d1 - Gamma311d3 + (Gamma311.*Gamma113 + Gamma312.*Gamma213 + Gamma313.*Gamma313) - (Gamma331.*Gamma111 + Gamma332.*Gamma211 + Gamma333.*Gamma311);
R3121 = Gamma311d2 - Gamma312d1 + (Gamma321.*Gamma111 + Gamma322.*Gamma211 + Gamma323.*Gamma311) - (Gamma311.*Gamma112 + Gamma312.*Gamma212 + Gamma313.*Gamma312);
R3122 = Gamma312d2 - Gamma312d2 + (Gamma321.*Gamma112 + Gamma322.*Gamma212 + Gamma323.*Gamma312) - (Gamma321.*Gamma112 + Gamma322.*Gamma212 + Gamma323.*Gamma312);
R3123 = Gamma313d2 - Gamma312d3 + (Gamma321.*Gamma113 + Gamma322.*Gamma213 + Gamma323.*Gamma313) - (Gamma331.*Gamma112 + Gamma332.*Gamma212 + Gamma333.*Gamma312);
R3131 = Gamma311d3 - Gamma313d1 + (Gamma331.*Gamma111 + Gamma332.*Gamma211 + Gamma333.*Gamma311) - (Gamma311.*Gamma113 + Gamma312.*Gamma213 + Gamma313.*Gamma313);
R3132 = Gamma312d3 - Gamma313d2 + (Gamma331.*Gamma112 + Gamma332.*Gamma212 + Gamma333.*Gamma312) - (Gamma321.*Gamma113 + Gamma322.*Gamma213 + Gamma323.*Gamma313);
R3133 = Gamma313d3 - Gamma313d3 + (Gamma331.*Gamma113 + Gamma332.*Gamma213 + Gamma333.*Gamma313) - (Gamma331.*Gamma113 + Gamma332.*Gamma213 + Gamma333.*Gamma313);
R3211 = Gamma321d1 - Gamma321d1 + (Gamma311.*Gamma121 + Gamma312.*Gamma221 + Gamma313.*Gamma321) - (Gamma311.*Gamma121 + Gamma312.*Gamma221 + Gamma313.*Gamma321);
R3212 = Gamma322d1 - Gamma321d2 + (Gamma311.*Gamma122 + Gamma312.*Gamma222 + Gamma313.*Gamma322) - (Gamma321.*Gamma121 + Gamma322.*Gamma221 + Gamma323.*Gamma321);
R3213 = Gamma323d1 - Gamma321d3 + (Gamma311.*Gamma123 + Gamma312.*Gamma223 + Gamma313.*Gamma323) - (Gamma331.*Gamma121 + Gamma332.*Gamma221 + Gamma333.*Gamma321);
R3221 = Gamma321d2 - Gamma322d1 + (Gamma321.*Gamma121 + Gamma322.*Gamma221 + Gamma323.*Gamma321) - (Gamma311.*Gamma122 + Gamma312.*Gamma222 + Gamma313.*Gamma322);
R3222 = Gamma322d2 - Gamma322d2 + (Gamma321.*Gamma122 + Gamma322.*Gamma222 + Gamma323.*Gamma322) - (Gamma321.*Gamma122 + Gamma322.*Gamma222 + Gamma323.*Gamma322);
R3223 = Gamma323d2 - Gamma322d3 + (Gamma321.*Gamma123 + Gamma322.*Gamma223 + Gamma323.*Gamma323) - (Gamma331.*Gamma122 + Gamma332.*Gamma222 + Gamma333.*Gamma322);
R3231 = Gamma321d3 - Gamma323d1 + (Gamma331.*Gamma121 + Gamma332.*Gamma221 + Gamma333.*Gamma321) - (Gamma311.*Gamma123 + Gamma312.*Gamma223 + Gamma313.*Gamma323);
R3232 = Gamma322d3 - Gamma323d2 + (Gamma331.*Gamma122 + Gamma332.*Gamma222 + Gamma333.*Gamma322) - (Gamma321.*Gamma123 + Gamma322.*Gamma223 + Gamma323.*Gamma323);
R3233 = Gamma323d3 - Gamma323d3 + (Gamma331.*Gamma123 + Gamma332.*Gamma223 + Gamma333.*Gamma323) - (Gamma331.*Gamma123 + Gamma332.*Gamma223 + Gamma333.*Gamma323);
R3311 = Gamma331d1 - Gamma331d1 + (Gamma311.*Gamma131 + Gamma312.*Gamma231 + Gamma313.*Gamma331) - (Gamma311.*Gamma131 + Gamma312.*Gamma231 + Gamma313.*Gamma331);
R3312 = Gamma332d1 - Gamma331d2 + (Gamma311.*Gamma132 + Gamma312.*Gamma232 + Gamma313.*Gamma332) - (Gamma321.*Gamma131 + Gamma322.*Gamma231 + Gamma323.*Gamma331);
R3313 = Gamma333d1 - Gamma331d3 + (Gamma311.*Gamma133 + Gamma312.*Gamma233 + Gamma313.*Gamma333) - (Gamma331.*Gamma131 + Gamma332.*Gamma231 + Gamma333.*Gamma331);
R3321 = Gamma331d2 - Gamma332d1 + (Gamma321.*Gamma131 + Gamma322.*Gamma231 + Gamma323.*Gamma331) - (Gamma311.*Gamma132 + Gamma312.*Gamma232 + Gamma313.*Gamma332);
R3322 = Gamma332d2 - Gamma332d2 + (Gamma321.*Gamma132 + Gamma322.*Gamma232 + Gamma323.*Gamma332) - (Gamma321.*Gamma132 + Gamma322.*Gamma232 + Gamma323.*Gamma332);
R3323 = Gamma333d2 - Gamma332d3 + (Gamma321.*Gamma133 + Gamma322.*Gamma233 + Gamma323.*Gamma333) - (Gamma331.*Gamma132 + Gamma332.*Gamma232 + Gamma333.*Gamma332);
R3331 = Gamma331d3 - Gamma333d1 + (Gamma331.*Gamma131 + Gamma332.*Gamma231 + Gamma333.*Gamma331) - (Gamma311.*Gamma133 + Gamma312.*Gamma233 + Gamma313.*Gamma333);
R3332 = Gamma332d3 - Gamma333d2 + (Gamma331.*Gamma132 + Gamma332.*Gamma232 + Gamma333.*Gamma332) - (Gamma321.*Gamma133 + Gamma322.*Gamma233 + Gamma323.*Gamma333);
R3333 = Gamma333d3 - Gamma333d3 + (Gamma331.*Gamma133 + Gamma332.*Gamma233 + Gamma333.*Gamma333) - (Gamma331.*Gamma133 + Gamma332.*Gamma233 + Gamma333.*Gamma333);

% Riemanntensor_lijk = g_ls*R_sijk
Riemanntensor1111 = g11.*R1111 + g12.*R2111 + g13.*R3111;
Riemanntensor1112 = g11.*R1112 + g12.*R2112 + g13.*R3112;
Riemanntensor1113 = g11.*R1113 + g12.*R2113 + g13.*R3113;
Riemanntensor1121 = g11.*R1121 + g12.*R2121 + g13.*R3121;
Riemanntensor1122 = g11.*R1122 + g12.*R2122 + g13.*R3122;
Riemanntensor1123 = g11.*R1123 + g12.*R2123 + g13.*R3123;
Riemanntensor1131 = g11.*R1131 + g12.*R2131 + g13.*R3131;
Riemanntensor1132 = g11.*R1132 + g12.*R2132 + g13.*R3132;
Riemanntensor1133 = g11.*R1133 + g12.*R2133 + g13.*R3133;
Riemanntensor1211 = g11.*R1211 + g12.*R2211 + g13.*R3211;
Riemanntensor1212 = g11.*R1212 + g12.*R2212 + g13.*R3212;
Riemanntensor1213 = g11.*R1213 + g12.*R2213 + g13.*R3213;
Riemanntensor1221 = g11.*R1221 + g12.*R2221 + g13.*R3221;
Riemanntensor1222 = g11.*R1222 + g12.*R2222 + g13.*R3222;
Riemanntensor1223 = g11.*R1223 + g12.*R2223 + g13.*R3223;
Riemanntensor1231 = g11.*R1231 + g12.*R2231 + g13.*R3231;
Riemanntensor1232 = g11.*R1232 + g12.*R2232 + g13.*R3232;
Riemanntensor1233 = g11.*R1233 + g12.*R2233 + g13.*R3233;
Riemanntensor1311 = g11.*R1311 + g12.*R2311 + g13.*R3311;
Riemanntensor1312 = g11.*R1312 + g12.*R2312 + g13.*R3312;
Riemanntensor1313 = g11.*R1313 + g12.*R2313 + g13.*R3313;
Riemanntensor1321 = g11.*R1321 + g12.*R2321 + g13.*R3321;
Riemanntensor1322 = g11.*R1322 + g12.*R2322 + g13.*R3322;
Riemanntensor1323 = g11.*R1323 + g12.*R2323 + g13.*R3323;
Riemanntensor1331 = g11.*R1331 + g12.*R2331 + g13.*R3331;
Riemanntensor1332 = g11.*R1332 + g12.*R2332 + g13.*R3332;
Riemanntensor1333 = g11.*R1333 + g12.*R2333 + g13.*R3333;
Riemanntensor2111 = g12.*R1111 + g22.*R2111 + g23.*R3111;
Riemanntensor2112 = g12.*R1112 + g22.*R2112 + g23.*R3112;
Riemanntensor2113 = g12.*R1113 + g22.*R2113 + g23.*R3113;
Riemanntensor2121 = g12.*R1121 + g22.*R2121 + g23.*R3121;
Riemanntensor2122 = g12.*R1122 + g22.*R2122 + g23.*R3122;
Riemanntensor2123 = g12.*R1123 + g22.*R2123 + g23.*R3123;
Riemanntensor2131 = g12.*R1131 + g22.*R2131 + g23.*R3131;
Riemanntensor2132 = g12.*R1132 + g22.*R2132 + g23.*R3132;
Riemanntensor2133 = g12.*R1133 + g22.*R2133 + g23.*R3133;
Riemanntensor2211 = g12.*R1211 + g22.*R2211 + g23.*R3211;
Riemanntensor2212 = g12.*R1212 + g22.*R2212 + g23.*R3212;
Riemanntensor2213 = g12.*R1213 + g22.*R2213 + g23.*R3213;
Riemanntensor2221 = g12.*R1221 + g22.*R2221 + g23.*R3221;
Riemanntensor2222 = g12.*R1222 + g22.*R2222 + g23.*R3222;
Riemanntensor2223 = g12.*R1223 + g22.*R2223 + g23.*R3223;
Riemanntensor2231 = g12.*R1231 + g22.*R2231 + g23.*R3231;
Riemanntensor2232 = g12.*R1232 + g22.*R2232 + g23.*R3232;
Riemanntensor2233 = g12.*R1233 + g22.*R2233 + g23.*R3233;
Riemanntensor2311 = g12.*R1311 + g22.*R2311 + g23.*R3311;
Riemanntensor2312 = g12.*R1312 + g22.*R2312 + g23.*R3312;
Riemanntensor2313 = g12.*R1313 + g22.*R2313 + g23.*R3313;
Riemanntensor2321 = g12.*R1321 + g22.*R2321 + g23.*R3321;
Riemanntensor2322 = g12.*R1322 + g22.*R2322 + g23.*R3322;
Riemanntensor2323 = g12.*R1323 + g22.*R2323 + g23.*R3323;
Riemanntensor2331 = g12.*R1331 + g22.*R2331 + g23.*R3331;
Riemanntensor2332 = g12.*R1332 + g22.*R2332 + g23.*R3332;
Riemanntensor2333 = g12.*R1333 + g22.*R2333 + g23.*R3333;
Riemanntensor3111 = g13.*R1111 + g23.*R2111 + g33.*R3111;
Riemanntensor3112 = g13.*R1112 + g23.*R2112 + g33.*R3112;
Riemanntensor3113 = g13.*R1113 + g23.*R2113 + g33.*R3113;
Riemanntensor3121 = g13.*R1121 + g23.*R2121 + g33.*R3121;
Riemanntensor3122 = g13.*R1122 + g23.*R2122 + g33.*R3122;
Riemanntensor3123 = g13.*R1123 + g23.*R2123 + g33.*R3123;
Riemanntensor3131 = g13.*R1131 + g23.*R2131 + g33.*R3131;
Riemanntensor3132 = g13.*R1132 + g23.*R2132 + g33.*R3132;
Riemanntensor3133 = g13.*R1133 + g23.*R2133 + g33.*R3133;
Riemanntensor3211 = g13.*R1211 + g23.*R2211 + g33.*R3211;
Riemanntensor3212 = g13.*R1212 + g23.*R2212 + g33.*R3212;
Riemanntensor3213 = g13.*R1213 + g23.*R2213 + g33.*R3213;
Riemanntensor3221 = g13.*R1221 + g23.*R2221 + g33.*R3221;
Riemanntensor3222 = g13.*R1222 + g23.*R2222 + g33.*R3222;
Riemanntensor3223 = g13.*R1223 + g23.*R2223 + g33.*R3223;
Riemanntensor3231 = g13.*R1231 + g23.*R2231 + g33.*R3231;
Riemanntensor3232 = g13.*R1232 + g23.*R2232 + g33.*R3232;
Riemanntensor3233 = g13.*R1233 + g23.*R2233 + g33.*R3233;
Riemanntensor3311 = g13.*R1311 + g23.*R2311 + g33.*R3311;
Riemanntensor3312 = g13.*R1312 + g23.*R2312 + g33.*R3312;
Riemanntensor3313 = g13.*R1313 + g23.*R2313 + g33.*R3313;
Riemanntensor3321 = g13.*R1321 + g23.*R2321 + g33.*R3321;
Riemanntensor3322 = g13.*R1322 + g23.*R2322 + g33.*R3322;
Riemanntensor3323 = g13.*R1323 + g23.*R2323 + g33.*R3323;
Riemanntensor3331 = g13.*R1331 + g23.*R2331 + g33.*R3331;
Riemanntensor3332 = g13.*R1332 + g23.*R2332 + g33.*R3332;
Riemanntensor3333 = g13.*R1333 + g23.*R2333 + g33.*R3333;

Riemanntensor = [Riemanntensor1111 Riemanntensor1112 Riemanntensor1113 Riemanntensor1121 Riemanntensor1122 Riemanntensor1123 Riemanntensor1131 Riemanntensor1132 Riemanntensor1133 Riemanntensor1211 Riemanntensor1212 Riemanntensor1213 Riemanntensor1221 Riemanntensor1222 Riemanntensor1223 Riemanntensor1231 Riemanntensor1232 Riemanntensor1233 Riemanntensor1311 Riemanntensor1312 Riemanntensor1313 Riemanntensor1321 Riemanntensor1322 Riemanntensor1323 Riemanntensor1331 Riemanntensor1332 Riemanntensor1333 Riemanntensor2111 Riemanntensor2112 Riemanntensor2113 Riemanntensor2121 Riemanntensor2122 Riemanntensor2123 Riemanntensor2131 Riemanntensor2132 Riemanntensor2133 Riemanntensor2211 Riemanntensor2212 Riemanntensor2213 Riemanntensor2221 Riemanntensor2222 Riemanntensor2223 Riemanntensor2231 Riemanntensor2232 Riemanntensor2233 Riemanntensor2311 Riemanntensor2312 Riemanntensor2313 Riemanntensor2321 Riemanntensor2322 Riemanntensor2323 Riemanntensor2331 Riemanntensor2332 Riemanntensor2333 Riemanntensor3111 Riemanntensor3112 Riemanntensor3113 Riemanntensor3121 Riemanntensor3122 Riemanntensor3123 Riemanntensor3131 Riemanntensor3132 Riemanntensor3133 Riemanntensor3211 Riemanntensor3212 Riemanntensor3213 Riemanntensor3221 Riemanntensor3222 Riemanntensor3223 Riemanntensor3231 Riemanntensor3232 Riemanntensor3233 Riemanntensor3311 Riemanntensor3312 Riemanntensor3313 Riemanntensor3321 Riemanntensor3322 Riemanntensor3323 Riemanntensor3331 Riemanntensor3332 Riemanntensor3333];

return